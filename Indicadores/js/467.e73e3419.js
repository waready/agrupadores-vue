"use strict";(self["webpackChunkIndicadores"]=self["webpackChunkIndicadores"]||[]).push([[467],{26556:function(a,s,e){e.r(s),e.d(s,{default:function(){return ga}});var t=e(73396),i=e(87139),r=e(49242);const l=a=>((0,t.dD)("data-v-f16b51c8"),a=a(),(0,t.Cn)(),a),o={class:"container"},c=["onClick"],n=l((()=>(0,t._)("i",{class:"fas fa-map-marker-alt text-white fa-xl"},null,-1))),d=[n],u={key:0},h=l((()=>(0,t._)("hr",null,null,-1))),g={class:"row"},m={class:"col-7 d-flex justify-content-center"},p={class:"col-5"},S={class:"col-12"},f={class:"card"},j={class:"card-content"},_={class:"card-body"},b={class:"media d-flex"},C=l((()=>(0,t._)("div",{class:"align-self-center"},[(0,t._)("i",{class:"icon-pie-chart font-large-2 float-left"})],-1))),v={class:"media-body text-right"},w=l((()=>(0,t._)("span",null,"Cajas Abiertas",-1))),y={class:"col-12"},A={class:"card"},k={class:"card-content"},x={class:"card-body"},T={class:"media d-flex"},P=l((()=>(0,t._)("div",{class:"align-self-center"},[(0,t._)("i",{class:"icon-pie-chart success font-large-2 float-left"})],-1))),B={class:"media-body text-right"},D=l((()=>(0,t._)("span",null,"Cajas Cerradas",-1))),U=l((()=>(0,t._)("hr",null,null,-1))),M={class:"nav nav-tabs mb-1"},z={class:"nav-item"},I={class:"nav-item"},N={class:"row"},O={class:"col-md-12 card"},E={class:"card-body"},V=l((()=>(0,t._)("h3",null,"Cajas Abiertas",-1))),Z={key:1,class:"alert alert-warning mt-1",role:"alert"},F=l((()=>(0,t._)("h3",null,"Cajas Cerradas",-1))),R={key:1,class:"alert alert-warning mt-1",role:"alert"},q={class:"modal fade",id:"exampleModalCenter",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalCenterTitle","aria-hidden":"true"},J={class:"modal-dialog modal-dialog-centered",role:"document"},H={class:"modal-content"},K={class:"modal-header"},Y=l((()=>(0,t._)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[(0,t._)("span",{"aria-hidden":"true"},"×")],-1))),W={class:"modal-body"},G={class:"card-body"},Q={class:"card-title"},X=l((()=>(0,t._)("i",{class:"fa fa-phone","aria-hidden":"true"},null,-1))),aa={class:"card-text"},sa=l((()=>(0,t._)("i",{class:"fa fa-map-marker","aria-hidden":"true"},null,-1))),ea={ref:"elMap",class:"app-store-map"},ta=l((()=>(0,t._)("div",{class:"modal-footer"},[(0,t._)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Cerrar ")],-1)));function ia(a,s,e,l,n,$){const L=(0,t.up)("Pie"),ia=(0,t.up)("v-client-table"),ra=(0,t.up)("loading");return(0,t.wg)(),(0,t.iD)("div",o,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(n.Sucursal,((a,s)=>((0,t.wg)(),(0,t.iD)("div",{key:s},[(0,t._)("h2",null,[(0,t.Uk)("Cajas de la Sucursal ( "+(0,i.zw)(a.descripcion)+" ) ",1),(0,t._)("a",{class:"btn btn-info mb-1",onClick:s=>$.generarSucursal(a.identificador),"data-toggle":"modal","data-placement":"top",title:"Ver mapa","data-target":"#exampleModalCenter"},d,8,c)])])))),128)),n.cajas?((0,t.wg)(),(0,t.iD)("div",u,[h,(0,t._)("div",g,[(0,t._)("div",m,[(0,t.Wm)(L,{id:"my-chart-id",data:n.chartData,style:(0,i.j5)($.myStyles),options:n.chartOptions},null,8,["data","style","options"])]),(0,t._)("div",p,[(0,t._)("div",S,[(0,t._)("div",f,[(0,t._)("div",j,[(0,t._)("div",_,[(0,t._)("div",b,[C,(0,t._)("div",v,[(0,t._)("h4",null,(0,i.zw)(n.cajasAbiertas.length),1),w])])])])])]),(0,t._)("div",y,[(0,t._)("div",A,[(0,t._)("div",k,[(0,t._)("div",x,[(0,t._)("div",T,[P,(0,t._)("div",B,[(0,t._)("h4",null,(0,i.zw)(n.cajasCerradas.length),1),D])])])])])])])]),U,(0,t._)("ul",M,[(0,t._)("li",z,[(0,t._)("a",{class:(0,i.C_)(["nav-link",{active:1==n.cajasA}]),onClick:s[0]||(s[0]=a=>$.selecionar(1))}," Cajas Abiertas ",2)]),(0,t._)("li",I,[(0,t._)("a",{class:(0,i.C_)(["nav-link",{active:1==a.cajasC}]),onClick:s[1]||(s[1]=a=>$.selecionar(2))}," Cajas Cerradas ",2)])]),(0,t._)("div",N,[(0,t._)("div",O,[(0,t._)("div",E,[(0,t.wy)((0,t._)("div",null,[V,n.cajasAbiertasPremiun[0]?((0,t.wg)(),(0,t.j4)(ia,{key:0,ref:"table",data:n.cajasAbiertasPremiun,columns:n.columns,options:n.options},{sesiones:(0,t.w5)((a=>[(0,t._)("a",{class:(0,i.C_)(["1"!=a.row.sesiones?"badge badge-danger text-white font-weight-bold":"badge badge-success  text-white font-weight-bold","letter"])},(0,i.zw)(a.row.sesiones),3)])),_:1},8,["data","columns","options"])):((0,t.wg)(),(0,t.iD)("div",Z,(0,i.zw)("No se encuentran registros!")))],512),[[r.F8,n.cajasA]]),(0,t.wy)((0,t._)("div",null,[F,n.cajasCerradasPremiun[0]?((0,t.wg)(),(0,t.j4)(ia,{key:0,ref:"table",data:n.cajasCerradasPremiun,columns:n.columns,options:n.options},{sesiones:(0,t.w5)((a=>[(0,t._)("a",{class:(0,i.C_)(["0"!=a.row.sesiones?"badge badge-danger text-white font-weight-bold":"badge badge-success  text-white font-weight-bold","letter"])},(0,i.zw)(a.row.sesiones),3)])),_:1},8,["data","columns","options"])):((0,t.wg)(),(0,t.iD)("div",R,(0,i.zw)("No se encuentran registros!")))],512),[[r.F8,a.cajasC]])])])])])):((0,t.wg)(),(0,t.j4)(ra,{key:1})),(0,t._)("div",q,[(0,t._)("div",J,[(0,t._)("div",H,[(0,t._)("div",K,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(n.Sucursal,((a,s)=>((0,t.wg)(),(0,t.iD)("div",{key:s},[(0,t._)("h5",null,"Sucursal: ( "+(0,i.zw)(a.descripcion)+" )",1)])))),128)),Y]),(0,t._)("div",W,[(0,t._)("div",null,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(n.cajasSelect,((a,s)=>((0,t.wg)(),(0,t.iD)("div",{class:"card",key:s},[(0,t._)("div",G,[(0,t._)("p",Q,[X,(0,t.Uk)(" "+(0,i.zw)(a.telefono),1)]),(0,t._)("p",aa,[sa,(0,t.Uk)(" "+(0,i.zw)(a.direccion),1)])])])))),128))]),(0,t._)("div",ea,null,512)]),ta])])])])}e(57658);var ra=e(29646),la=e(15866),oa=e(11393),ca=e(28666),na=e(49161);ra.kL.register(ra.qi,ra.u,ra.De);var da={name:"sucursales",mounted(){this.getAllSeciones();const a=JSON.parse(this.$route.query.datos),s=JSON.parse(this.$route.query.caja);1==s&&(this.cajasA=!1,this.cajasC=!0),this.getSucursalesCajas(a)},components:{Pie:la.by,loading:ca.Z,ServerTable:na.wv},data(){return{Sucursal:null,cajasA:!0,cajasB:!1,cajas:!1,mostrar:!1,sesiones:null,TextoBuscado:"",cajasSelect:null,cajasAbiertas:[],cajasCerradas:[],cajasAbiertasPremiun:[],cajasCerradasPremiun:[],chartData:{labels:["January","February","March"],datasets:[{data:[40,20,12]}]},chartOptions:{maintainAspectRatio:!1},columns:["indicador","usuario","nombre","sesiones"],options:{sortIcon:{is:"fa-sort",base:"fa",up:"fa-sort-asc",down:"fa-sort-desc"},texts:{count:"Mostrando {from} a {to} de {count} registros |{count} registros|Un registro",first:"Primero",last:"Ultimo",filter:"Filtro:",filterPlaceholder:"Búsqueda",limit:"Registros:",page:"Pagina:",noResults:"No hay registros coincidentes",noRequest:"Seleccione al menos un filtro para obtener resultados",filterBy:"Filtrar por {column}",loading:"Cargando...",defaultOption:"Seleccionar {column}",columns:"Columnas"},perPage:10,perPageValues:[10,25,50,100,500],headings:{indicador:"# CAJA",usuario:"USUARIO",nombre:"NOMBRE",sesiones:"SESIONES"}}}},methods:{async getAllSeciones(){await oa.Z.getSesionesPorUsuario().then((a=>{a.Erroresnegocio&&a.Erroresnegocio.BTErrorNegocio[0]&&(this.message=a.Erroresnegocio.BTErrorNegocio[0].Descripcion,"Sesión inválida"==this.message&&setTimeout((()=>{oa.Z.logout(),this.$store.dispatch("logout"),this.$router.push("/login")}),3e3)),this.sesiones=a.sdtSesionesPorUsuario.sBTSesionesPorUsuario,this.sesiones[0]||(this.message="No se encuentran registros!")}))},async getSucursalesCajas(a){await oa.Z.getSucursalesCajas().then((s=>{this.Sucursal=s.sdtSucursalesCajas.listadoSucursalesA.SdtsBTSucursal.filter((s=>s.identificador==a)),this.cajas=!0,this.cajasAbiertas=s.sdtSucursalesCajas.listadoCajasA.SdtsBTCaja.filter((s=>s.sucursalId==a)),this.cajasCerradas=s.sdtSucursalesCajas.listadoCajasC.SdtsBTCaja.filter((s=>s.sucursalId==a));let e=this.cajasAbiertas.map((a=>{var e=null;e=s.sdtSucursalesCajas.listadoSucursalesC.SdtsBTSucursal.filter((s=>s.identificador==a.sucursalId)),this.cajasSelect||(e=s.sdtSucursalesCajas.listadoSucursalesA.SdtsBTSucursal.filter((s=>s.identificador==a.sucursalId))),a.Sucursal=e[0].descripcion;const t=this.sesiones.find((s=>s.usuario===a.usuario));return a.sesiones=t?t.cantidadSesiones:0,a}));this.cajasCerradasPremiun=this.cajasCerradas.map((a=>{let e=s.sdtSucursalesCajas.listadoSucursalesC.SdtsBTSucursal.filter((s=>s.identificador==a.sucursalId));e.length||(e=s.sdtSucursalesCajas.listadoSucursalesA.SdtsBTSucursal.filter((s=>s.identificador==a.sucursalId))),a.Sucursal=e[0].descripcion;const t=this.sesiones.find((s=>s.usuario===a.usuario));return a.sesiones=t?t.cantidadSesiones:0,a})),this.chartData={labels:["Abiertas","Cerradas"],datasets:[{backgroundColor:["#525e5e","#41B883"],data:[e.length,s.sdtSucursalesCajas.cajasCerradas]}]},this.cajasAbiertasPremiun=e,$(document).ready((function(){$(".VuePagination__count").text((function(a,s){return s.replace("Un registro","1 registro")})),$(".VueTables__search-field label").hide(),$(".VueTables__limit-field label").hide(),$(".VuePagination__pagination").addClass("justify-content-center")}))}))},async generarSucursal(a){await oa.Z.getSucursalesCajas().then((s=>{this.cajasSelect=s.sdtSucursalesCajas.listadoSucursalesC.SdtsBTSucursal.filter((s=>s.identificador==a)),this.cajasSelect[0]||(this.cajasSelect=s.sdtSucursalesCajas.listadoSucursalesA.SdtsBTSucursal.filter((s=>s.identificador==a)))})),await this.generarMapa(this.cajasSelect[0].latitud,this.cajasSelect[0].longitud)},async generarMapa(a,s){this.$options.markers=new Array;var e=this.$refs.elMap;setTimeout((function(){const t=L.map(e).setView([a,s],10);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',maxZoom:18}).addTo(t);L.marker([a,s]).addTo(t)}),1e3)},selecionar(a){1==a&&(this.cajasA=!0,this.cajasC=!1),2==a&&(this.cajasA=!1,this.cajasC=!0)}},computed:{myStyles(){return{height:"325px"}},CajasFilter(){var a=this.TextoBuscado.toUpperCase();return this.cajasAbiertasPremiun.filter((s=>s.nombre.toUpperCase().includes(a)||s.Sucursal.toUpperCase().includes(a)))}},watch:{cajasSelect:{deep:!0,handler(a){console.log("cambios"),a.length>0&&(this.generarMapa(a[0].latitud,a[0].longitud),this.$nextTick((()=>{this.$options.map&&this.$options.map.invalidateSize()})))}}}},ua=e(40089);const ha=(0,ua.Z)(da,[["render",ia],["__scopeId","data-v-f16b51c8"]]);var ga=ha}}]);
//# sourceMappingURL=467.e73e3419.js.map